import{_ as a,o as l,c as n,a as i,t as c,w as h,n as d,b as w}from"./index-8765694e.js";const u={data(){return{view:{viewId:null},isCollected:!1,isClick:!1}},methods:{render(e){this.axios.get(`https://two023-js-week0-server.onrender.com/views/${e}`).then(s=>{this.view={...this.view,...s.data},this.view.id=null})},addCollect(){if(this.isCollected&&this.view.userId){alert("已加入收藏");return}const e=document.cookie.replace(/(?:(?:^|.*;\s*)userToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.axios.post("https://two023-js-week0-server.onrender.com/600/collects",this.view,{headers:{authorization:`Bearer ${e}`}}).then(()=>{alert("加入成功"),this.isCollected=!0}).catch(()=>{alert("請先登入"),this.$router.push("/login")})},checkCollects(){this.axios.get(`https://two023-js-week0-server.onrender.com/collects?userId=${this.view.userId}`).then(e=>{!!e.data.find(this.a)&&(this.isCollected=!0,this.isClick=!0)}).catch(e=>{console.log(e)})},a(e){return e.viewId===this.view.viewId}},mounted(){const e=window.location.href.split("=")[1];this.view.viewId=e;const s=document.cookie.replace(/(?:(?:^|.*;\s*)userId\s*=\s*([^;]*).*$)|^.*$/,"$1");this.view.userId=s,this.render(e),this.checkCollects()}},v={class:"container mt-5"},k=i("h1",null,"景點詳細",-1),p={class:"fw-bold"};function C(e,s,m,f,t,o){return l(),n("div",v,[k,i("h2",p,c(t.view.name),1),i("p",null,c(t.view.description),1),t.view.userId!==""?(l(),n("a",{key:0,href:"#",onClick:s[1]||(s[1]=h((...r)=>o.addCollect&&o.addCollect(...r),["prevent"]))},[i("span",{class:d({"d-none":!t.isClick})},"已收藏",2),i("span",{class:d({"d-none":t.isClick}),onClick:s[0]||(s[0]=r=>t.isClick=!t.isClick)},"加入收藏",2)])):w("",!0)])}const _=a(u,[["render",C]]);export{_ as default};
